{# templates/admin/index.html.twig #}

{% extends 'base.html.twig' %}

{% block title %}Panneau d'administration{% endblock %}

{% block stylesheets %}
    {# Inclut les styles généraux de votre application #}
    <link rel="stylesheet" href="{{ asset('styles/admin.css') }}">
{% endblock %}

{% block top_header_content %}
    {{ parent() }}
{% endblock %}

{% block bottom_header_content %}
    {# Ce bloc est laissé vide pour ne pas afficher le contenu #}
{% endblock %}

{% block body %}
<main class="admin-dashboard">
    <h1>Tableau de bord administrateur</h1>

    <div class="admin-section">
        <h2>Utilisateurs ({{ users|length }})</h2>
        {# Bouton pour basculer la liste des utilisateurs #}
        <button id="toggle-users" class="btn btn-secondary btn-sm mb-3">Afficher la liste</button>
        {# La liste des utilisateurs, avec l'id nécessaire au JavaScript #}
        <ul class="admin-list" id="user-list">
            {% for user in users %}
                <li>
                    <span>{{ user.username }} ({{ user.email }})</span>
                    <div class="admin-actions">
                        <a href="{{ path('app_user_profile', {'id': user.id}) }}" class="btn btn-info btn-sm">Voir profil</a>
                    </div>
                </li>
            {% endfor %}
        </ul>
    </div>

    <div class="admin-section">
        <h2>Événements ({{ events|length }})</h2>
        {# Bouton pour basculer la liste des événements #}
        <button id="toggle-events" class="btn btn-secondary btn-sm mb-3">Afficher la liste</button>
        {# La liste des événements, avec l'id nécessaire au JavaScript #}
        <ul class="admin-list" id="event-list">
            {% for event in events %}
                <li>
                    <span>{{ event.title }}</span>
                    <div class="admin-actions">
                        <a href="{{ path('app_event_show', {'id': event.id}) }}" class="btn btn-info btn-sm">Voir</a>
                        <a href="{{ path('app_event_edit', {'id': event.id}) }}" class="btn btn-warning btn-sm">Modifier</a>
                        <form method="post" action="{{ path('app_event_delete', {'id': event.id}) }}" style="display:inline-block" onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer cet événement ?');">
                            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ event.id) }}">
                            <button class="btn btn-danger btn-sm">Supprimer</button>
                        </form>
                    </div>
                </li>
            {% endfor %}
        </ul>
    </div>
</main>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('js/admin.js') }}"></script>
{% endblock %}